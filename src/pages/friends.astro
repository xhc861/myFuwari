---
import MainGridLayout from "../layouts/MainGridLayout.astro";
import I18nKey from "../i18n/i18nKey";
import { i18n } from "../i18n/translation";
import { siteConfig } from "../config";
import { friends } from "../friends";
import FriendCard from "../components/FriendCard.astro";

// 分离置顶和非置顶友链
const pinnedFriends = friends.filter((friend) => friend.pin === true);
const nonPinnedFriends = friends.filter((friend) => friend.pin !== true);

// 对非置顶友链进行随机排序
const shuffledNonPinnedFriends = nonPinnedFriends.sort(
	() => Math.random() - 0.5
);

// 合并置顶和随机排序的非置顶友链
const sortedFriends = [...pinnedFriends, ...shuffledNonPinnedFriends];
---

<MainGridLayout 
	title={i18n(I18nKey.friends)} 
	description={i18n(I18nKey.friends)}
>
	<div class="space-y-8">
		<!-- 标题部分 -->
		<div class="space-y-3">
			<br><br>  <!-- 两个br能解决的干嘛要重写css呢(/doge) -->
			<h1 class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-gray-100">
				{i18n(I18nKey.friends)}
			</h1>
			<p class="text-lg text-gray-600 dark:text-gray-400">
				一群志同道合的朋友，一起分享知识和经验
			</p>
		</div>

		<!-- 友链卡片网格 -->
		<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
			{
				sortedFriends.map((friend) => (
					<FriendCard
						name={friend.name}
						desc={friend.desc}
						avatar={friend.avatar}
						url={friend.url}
						pin={friend.pin}
					/>
				))
			}
		</div>

		<!-- 申请友链部分 -->
		<section class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
			<div class="space-y-4">
				<h2 class="text-3xl font-bold text-gray-900 dark:text-gray-100">
					{i18n(I18nKey.friendLink)}
				</h2>
				<p class="text-gray-600 dark:text-gray-400 leading-relaxed">
					{i18n(I18nKey.friendLinkDescription)}
				</p>

				<!-- 联系方式卡片 -->
				<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
					<!-- 邮件联系 -->
					<a
						href="mailto:xhc861@siiway.org"
						class="group relative overflow-hidden rounded-xl p-6 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950/30 dark:to-blue-900/20 border border-blue-200 dark:border-blue-800 hover:shadow-lg transition-all duration-300"
					>
						<div class="absolute inset-0 bg-gradient-to-br from-blue-400/0 to-blue-500/0 group-hover:from-blue-400/10 group-hover:to-blue-500/10 transition-all duration-300"></div>
						<div class="relative z-10 flex items-center gap-4">
							<div class="p-3 bg-white dark:bg-gray-800 rounded-lg group-hover:scale-110 transition-transform duration-300">
								<svg class="w-6 h-6 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
									<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
								</svg>
							</div>
							<div>
								<h3 class="font-bold text-gray-900 dark:text-gray-100">邮件</h3>
								<p class="text-sm text-gray-600 dark:text-gray-400">xhc861@siiway.org</p>
							</div>
						</div>
					</a>

					<!-- Telegram 联系 -->
					<a
						href="https://t.me/xhc9510"
						target="_blank"
						rel="noopener noreferrer"
						class="group relative overflow-hidden rounded-xl p-6 bg-gradient-to-br from-cyan-50 to-cyan-100 dark:from-cyan-950/30 dark:to-cyan-900/20 border border-cyan-200 dark:border-cyan-800 hover:shadow-lg transition-all duration-300"
					>
						<div class="absolute inset-0 bg-gradient-to-br from-cyan-400/0 to-cyan-500/0 group-hover:from-cyan-400/10 group-hover:to-cyan-500/10 transition-all duration-300"></div>
						<div class="relative z-10 flex items-center gap-4">
							<div class="p-3 bg-white dark:bg-gray-800 rounded-lg group-hover:scale-110 transition-transform duration-300">
								<svg class="w-6 h-6 text-cyan-600 dark:text-cyan-400" fill="currentColor" viewBox="0 0 24 24">
									<path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.894 8.221l-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.16.16-.295.295-.605.295-.042 0-.085 0-.128-.01l.213-3.053 5.56-5.023c.242-.213-.054-.328-.373-.115L6.365 13.92l-2.99-.924c-.64-.203-.658-.64.135-.954l11.703-4.52c.54-.22 1.012.131.84.957z"/>
								</svg>
							</div>
							<div>
								<h3 class="font-bold text-gray-900 dark:text-gray-100">Telegram</h3>
								<p class="text-sm text-gray-600 dark:text-gray-400">@xhc9510</p>
							</div>
						</div>
					</a>
				</div>

				<!-- 友链要求 -->
				<div class="mt-8 p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700">
					<h3 class="font-bold text-gray-900 dark:text-gray-100 mb-4">友链要求</h3>
					<ul class="space-y-2 text-gray-600 dark:text-gray-400 text-sm">
						<li class="flex items-start gap-3">
							<span class="text-blue-500 dark:text-blue-400 font-bold mt-0.5">✓</span>
							<span>拥有自己固定域名的个人博客</span>
						</li>
						<li class="flex items-start gap-3">
							<span class="text-blue-500 dark:text-blue-400 font-bold mt-0.5">✓</span>
							<span>内容积极向上（个人观点和国外技术等除外）</span>
						</li>
						<li class="flex items-start gap-3">
							<span class="text-blue-500 dark:text-blue-400 font-bold mt-0.5">✓</span>
							<span>具清晰的博客描述和头像</span>
						</li>
						<li class="flex items-start gap-3">
							<span class="text-blue-500 dark:text-blue-400 font-bold mt-0.5">✓</span>
							<span>已添加本站友链（可直接fork或copy）</span>
						</li>
						<li class="flex items-start gap-3">
							<span class="text-blue-500 dark:text-blue-400 font-bold mt-0.5">✓</span>
							<span>SiiWay官方交流群内的群友可直接联系添加</span>
						</li>
					</ul>
				</div>
			</div>
		</section>

		<!-- 统计信息 -->
		<div class="mt-8 grid grid-cols-2 md:grid-cols-3 gap-4 overflow-hidden">
			<div class="p-4 bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-950/30 dark:to-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800 min-w-0">
				<div class="text-3xl font-bold text-blue-600 dark:text-blue-400 truncate">{sortedFriends.length}</div>
				<div class="text-sm text-gray-600 dark:text-gray-400 mt-1 truncate">友链总数</div>
			</div>
			<div class="p-4 bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-950/30 dark:to-purple-900/20 rounded-lg border border-purple-200 dark:border-purple-800 min-w-0">
				<div class="text-3xl font-bold text-purple-600 dark:text-purple-400 truncate">{pinnedFriends.length}</div>
				<div class="text-sm text-gray-600 dark:text-gray-400 mt-1 truncate">置顶友链</div>
			</div>
			<div class="p-4 bg-gradient-to-br from-pink-50 to-pink-100 dark:from-pink-950/30 dark:to-pink-900/20 rounded-lg border border-pink-200 dark:border-pink-800 min-w-0">
				<div class="text-3xl font-bold text-pink-600 dark:text-pink-400 truncate">{nonPinnedFriends.length}</div>
				<div class="text-sm text-gray-600 dark:text-gray-400 mt-1 truncate">普通友链</div>
			</div>
		</div>
	</div>
</MainGridLayout>

<style>
	:global(.dark) .group:hover {
		@apply shadow-lg;
	}
</style>
